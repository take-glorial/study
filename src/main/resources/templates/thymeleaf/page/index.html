<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorator="thymeleaf/layout/main">

<!--
page Css
<th:block layout:fragment="pageCss">
	<link rel="stylesheet" th:href="@{/css/page/home.css}">
</th:block>
-->

<!-- page 스크립트 -->
<th:block layout:fragment="pageScript">
	<script th:src="@{/js/board.js}"></script>

	<script>
		$(document).ready(function () {
			$("#btnForm").on("click",function(){
				const mainDTO = {searchText:'ajax post 테스트'};
				const queryString = Object.keys(mainDTO)
										    .map(key => `${encodeURIComponent(key)}=${encodeURIComponent(mainDTO[key])}`)
										    .join('&');

				$.ajax({
			        url: "/formTest",
			        data : queryString,
			        type:"post",
				}).done(function(fragment){
			    	$("#boardList").replaceWith(fragment);
			    }).fail(function(err){
			    	console.log('error', err);
			    });
			});

			$("#btnAjax").on("click",function(){
				const mainDTO = {searchText:'ajax post 테스트'};
				const queryString = Object.keys(mainDTO)
										    .map(key => `${encodeURIComponent(key)}=${encodeURIComponent(mainDTO[key])}`)
										    .join('&');

				$.ajax({
			        url : "/ajaxTest",
			        data : queryString,
			        type :"post",
			        contentType : "application/json",
			        cache : false
				}).done(function(fragment){
			    	$("#boardList").replaceWith(fragment);
			    }).fail(function(err){
			    	console.log('error', err);
			    });
			});

			$("#btnFetch").on("click", function(){
				boardSelect({searchText:'fetch post 테스트'})
			    .then(res => $("#boardList").replaceWith(res))
			    .catch(err => console.error(err));
			});
		});
	</script>
</th:block>

<main layout:fragment="page" role="main" class="flex-shrink-0">
	<div class="container">
	    <h1 class="mt-5">업무화면</h1>
	    <p class="lead">어쩌고 저쩌고</p>

		<input value="formTest" type="button" id="btnForm" >
		<input value="ajaxTest" type="button" id="btnAjax" >
		<input value="fetchTest" type="button" id="btnFetch" >

	    <div id="boardList">
	    	<th:block th:if="${ mainDTO != null }">
		    	<span th:text="${ mainDTO.searchText }">보드테스트</span>
		    </th:block>
	    </div>
	  </div>
</main>

</html>